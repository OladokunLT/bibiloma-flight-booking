<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="TechyDevs" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Bibilomo - Admin Dashboard</title>
    <!-- Favicon -->
    <link rel="icon" href="images/favicon.png" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet"
    />

    <!-- Template CSS Files -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/select2.min.css" />
    <link rel="stylesheet" href="css/line-awesome.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/owl.theme.default.min.css" />
    <link rel="stylesheet" href="css/jquery.fancybox.min.css" />
    <link rel="stylesheet" href="css/daterangepicker.css" />
    <link rel="stylesheet" href="css/animate.min.css" />
    <link rel="stylesheet" href="css/animated-headline.css" />
    <link rel="stylesheet" href="css/jquery-ui.css" />
    <link rel="stylesheet" href="css/flag-icon.min.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body class="section-bg">
    <!-- start cssload-loader -->
    <div class="preloader" id="preloader">
      <div class="loader">
        <svg class="spinner" viewBox="0 0 50 50">
          <circle
            class="path"
            cx="25"
            cy="25"
            r="20"
            fill="none"
            stroke-width="5"
          ></circle>
        </svg>
      </div>
    </div>
    <!-- end cssload-loader -->

    <!-- ================================
       START USER CANVAS MENU
================================= -->
    <!-- Start below user-canvas-container -->
      <!-- user-canvas-container removed from here -->
    <!-- end user-canvas-container -->
    <!-- ================================
       END USER CANVAS MENU
================================= -->

    <!-- ================================
       START DASHBOARD NAV
================================= -->
    <div class="sidebar-nav sidebar--nav">
      <div class="sidebar-nav-body">
        <div class="side-menu-close">
          <i class="la la-times"></i>
        </div>
        <!-- end menu-toggler -->
        <div class="author-content">
          <div class="d-flex align-items-center">
            <div class="author-img avatar-sm">
              <img src="images/team9.jpg" alt="testimonial image" />
            </div>
            <div class="author-bio">
              <h4 class="author__title">Bibilomo Travels </h4>
              <span class="author__meta">Welcome to Admin Panel</span>
            </div>
          </div>
        </div>
        <div class="sidebar-menu-wrap">
          <ul class="sidebar-menu toggle-menu list-items">
            <li class="page-active">
              <a href="admin-dashboard.html"
                ><i class="la la-dashboard me-2"></i>Dashboard</a
              >
            </li>
            <li>
              <span class="side-menu-icon toggle-menu-icon">
                <i class="la la-angle-down"></i>
              </span>
              <a href="#"
                ><i class="la la-plane me-2 text-color-4"></i>Flight</a
              >
              <ul class="toggle-drop-menu">
                <li>
                  <a href="./create-new-flight.html"
                >Add New Flight </a
              >
                </li>
                <li>
                  <a href="admin-dashboard-booking.html"
                >View Flight Records</a
              >
                </li>
                <!-- <li><a href="admin-dashboard-booking.html"
                  >All Flight
                  Application</a
                ></li> -->
              </ul>
            </li>
            

          <!--
            <li>
              <span class="side-menu-icon toggle-menu-icon">
                <i class="la la-angle-down"></i>
              </span>
              <a href="#"
                ><i class="la la-list me-2 text-color-2"></i>Tours</a
              >
              <ul class="toggle-drop-menu">
                <li>
                  <a href="#"
                >Add New Tour </a
              >
                </li>
                <li>
                  <a href="admin-dashboard-booking.html"
                >View Tours Records</a
              >
                </li>
              </ul>
            </li>
          -->  
            <li>
              <span class="side-menu-icon toggle-menu-icon">
                <i class="la la-angle-down"></i>
              </span>
              <a href="#"
                ><i class="la la-heart me-2 text-color-6"></i>Notifications</a
              >
              <ul class="toggle-drop-menu">
                <li><a href="contact-message.html">Contact Inquiries</a></li>
                <li><a href="booking-application.html">Booking Application Records</a></li>
              </ul>
            </li>
            
            <li>
              <a href="admin-dashboard-settings.html"
                ><i class="la la-cog me-2 text-color-10"></i>Settings</a
              >
            </li>
          

            <li>
              <a href="index.html" id="logout-link"
                ><i class="la la-power-off me-2 text-color-11"></i>Logout</a
              >
            </li>
          </ul>
        </div>
        <!-- end sidebar-menu-wrap -->
      </div>
    </div>
    <!-- end sidebar-nav -->
    <!-- ================================
       END DASHBOARD NAV
================================= -->

    <!-- ================================
    START DASHBOARD AREA
================================= -->
    <section class="dashboard-area">
      <div class="dashboard-nav dashboard--nav" >
        <div class="container-fluid" >
          <div class="row" >
            <div class="col-lg-12">
              <div class="menu-wrapper">
                <div class="logo me-5" style="display: flex;"><h2 style="color: #fff; font-size: 25px;">Bibilomo Travels </h2>
                  <a href="index.html"
                    ><img src="images/logoicon.png" width="30" alt="logo"
                  /> </a>
                  <div class="menu-toggler">
                    <i class="la la-bars"></i>
                    <i class="la la-times"></i>
                  </div>
                  <!-- end menu-toggler -->
                  <div class="user-menu-open">
                    <i class="la la-user"></i>
                  </div>
                  <!-- end user-menu-open -->
                </div>
                <!-- <div class="dashboard-search-box">
                  <div class="contact-form-action">
                    <form action="#">
                      <div class="form-group mb-0">
                        <input
                          class="form-control"
                          type="text"
                          name="text"
                          placeholder="Search"
                        />
                        <button class="search-btn">
                          <i class="la la-search"></i>
                        </button>
                      </div>
                    </form>
                  </div>
                </div> -->
                <div class="nav-btn ms-auto">
                  <div class="notification-wrap d-flex align-items-center">
                    <div class="notification-item me-2">
                      <div class="dropdown">
                        <a
                          href="booking-application.html"
                          class="dropdown-toggle drop-reveal-toggle-icon"
                          id="notificationDropdownMenu"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false"
                        >
                          <i class="la la-bell"></i>
                          <span class="noti-count" id="booking-noti-count">4</span>
                        </a>
                        <!-- <div
                          class="dropdown-menu dropdown-reveal dropdown-menu-xl dropdown-menu-right"
                        >
                          <div class="dropdown-header drop-reveal-header">
                            <h6 class="title">
                              You have
                              <strong class="text-black">4</strong>
                              notifications
                            </h6>
                          </div>
                          <div class="list-group drop-reveal-list">
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div
                                  class="icon-element flex-shrink-0 me-3 ms-0"
                                >
                                  <i class="la la-bell"></i>
                                </div>
                                <div class="msg-content w-100">
                                  <h3 class="title pb-1">
                                    Your request has been sent
                                  </h3>
                                  <p class="msg-text">2 min ago</p>
                                </div>
                              </div>
                              
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div
                                  class="icon-element bg-2 flex-shrink-0 me-3 ms-0"
                                >
                                  <i class="la la-check"></i>
                                </div>
                                <div class="msg-content w-100">
                                  <h3 class="title pb-1">
                                    Your account has been created
                                  </h3>
                                  <p class="msg-text">1 day ago</p>
                                </div>
                              </div>
                              
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div
                                  class="icon-element bg-3 flex-shrink-0 me-3 ms-0"
                                >
                                  <i class="la la-user"></i>
                                </div>
                                <div class="msg-content w-100">
                                  <h3 class="title pb-1">
                                    Your account updated
                                  </h3>
                                  <p class="msg-text">2 hrs ago</p>
                                </div>
                              </div>
                              
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div
                                  class="icon-element bg-4 flex-shrink-0 me-3 ms-0"
                                >
                                  <i class="la la-lock"></i>
                                </div>
                                <div class="msg-content w-100">
                                  <h3 class="title pb-1">
                                    Your password changed
                                  </h3>
                                  <p class="msg-text">Yesterday</p>
                                </div>
                              </div>
                             
                            </a>
                          </div>
                          <a
                            href="#"
                            class="dropdown-item drop-reveal-btn text-center"
                            >View all</a
                          >
                        </div> -->
                        <!-- end dropdown-menu -->
                      </div>
                    </div>
                    <!-- end notification-item -->
                    <div class="notification-item me-2">
                      <div class="dropdown">
                        <a
                          href="contact-message.html"
                          class="dropdown-toggle drop-reveal-toggle-icon"
                          id="messageDropdownMenu"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false"
                        >
                          <i class="la la-envelope"></i>
                          <span class="noti-count" id="contactRecentCount">4</span>
                        </a>
                        <!-- <div
                          class="dropdown-menu dropdown-reveal dropdown-menu-xl dropdown-menu-right"
                        >
                          <div class="dropdown-header drop-reveal-header">
                            <h6 class="title">
                              You have
                              <strong class="text-black">4</strong> messages
                            </h6>
                          </div>
                          <div class="list-group drop-reveal-list">
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div class="avatar flex-shrink-0 me-3">
                                  <img src="images/team8.jpg" alt="" />
                                </div>
                                <div class="msg-content w-100">
                                  <div
                                    class="d-flex align-items-center justify-content-between"
                                  >
                                    <h3 class="title pb-1">Steve Wornder</h3>
                                    <span class="msg-text">3 min ago</span>
                                  </div>
                                  <p class="msg-text">
                                    Ancillae delectus necessitatibus no eam
                                  </p>
                                </div>
                              </div>
                          
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div class="avatar flex-shrink-0 me-3">
                                  <img src="images/team9.jpg" alt="" />
                                </div>
                                <div class="msg-content w-100">
                                  <div
                                    class="d-flex align-items-center justify-content-between"
                                  >
                                    <h3 class="title pb-1">Marc Twain</h3>
                                    <span class="msg-text">1 hrs ago</span>
                                  </div>
                                  <p class="msg-text">
                                    Ancillae delectus necessitatibus no eam
                                  </p>
                                </div>
                              </div>
                            
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div class="avatar flex-shrink-0 me-3">
                                  <img src="images/team10.jpg" alt="" />
                                </div>
                                <div class="msg-content w-100">
                                  <div
                                    class="d-flex align-items-center justify-content-between"
                                  >
                                    <h3 class="title pb-1">Enzo Ferrari</h3>
                                    <span class="msg-text">2 hrs ago</span>
                                  </div>
                                  <p class="msg-text">
                                    Ancillae delectus necessitatibus no eam
                                  </p>
                                </div>
                              </div>
                          
                            </a>
                            <a
                              href="#"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body d-flex align-items-center">
                                <div class="avatar flex-shrink-0 me-3">
                                  <img src="images/team11.jpg" alt="" />
                                </div>
                                <div class="msg-content w-100">
                                  <div
                                    class="d-flex align-items-center justify-content-between"
                                  >
                                    <h3 class="title pb-1">Lucas Swing</h3>
                                    <span class="msg-text">3 hrs ago</span>
                                  </div>
                                  <p class="msg-text">
                                    Ancillae delectus necessitatibus no eam
                                  </p>
                                </div>
                              </div>
                              
                            </a>
                          </div>
                          <a
                            href="#"
                            class="dropdown-item drop-reveal-btn text-center"
                            >View all</a
                          >
                        </div> -->
                        <!-- end dropdown-menu -->
                      </div>
                    </div>
                    <!-- end notification-item -->
                    <div class="notification-item">
                      <div class="dropdown">
                        <a
                          href="#"
                          class="dropdown-toggle"
                          id="userDropdownMenu"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false"
                        >
                          <div class="d-flex align-items-center">
                            <div class="avatar avatar-sm flex-shrink-0 me-2">
                              <img src="images/team8.jpg" alt="team-img" />
                            </div>
                            <span class="font-size-14 font-weight-bold"
                              > Admin</span
                            >
                          </div>
                        </a>
                        <div
                          class="dropdown-menu dropdown-reveal dropdown-menu-md dropdown-menu-right"
                        >
                          <div
                            class="dropdown-item drop-reveal-header user-reveal-header"
                          >
                            <h6 class="title text-uppercase">Welcome!</h6>
                          </div>
                          <div
                            class="list-group drop-reveal-list user-drop-reveal-list"
                          >
                            <!-- <a
                              href="admin-dashboard-settings.html"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body">
                                <div class="msg-content">
                                  <h3 class="title">
                                    <i class="la la-user me-2"></i> Edit Profile
                                  </h3>
                                </div>
                              </div>
                              
                            </a> -->
                            <a
                              href="booking-application.html"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body">
                                <div class="msg-content">
                                  <h3 class="title">
                                    <i class="la la-shopping-cart me-2"></i
                                    >Orders
                                  </h3>
                                </div>
                              </div>
                              <!-- end msg-body -->
                            </a>
                            <a
                              href="contact-message.html"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body">
                                <div class="msg-content">
                                  <h3 class="title">
                                    <i class="la la-bell me-2"></i>Messages
                                  </h3>
                                </div>
                              </div>
                              <!-- end msg-body -->
                            </a>
                            <a
                              href="admin-dashboard-settings.html"
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body">
                                <div class="msg-content">
                                  <h3 class="title">
                                    <i class="la la-gear me-2"></i>Settings
                                  </h3>
                                </div>
                              </div>
                              <!-- end msg-body -->
                            </a>
                            <div class="section-block"></div>
                            <a
                              id="logout-link"
                              href="index.html" 
                              class="list-group-item list-group-item-action"
                            >
                              <div class="msg-body">
                                <div class="msg-content">
                                  <h3 class="title">
                                    <i class="la la-power-off me-2"></i>Logout
                                  </h3>
                                </div>
                              </div>
                              <!-- end msg-body -->
                            </a>
                          </div>
                        </div>
                        <!-- end dropdown-menu -->
                      </div>
                    </div>
                    <!-- end notification-item -->
                  </div>
                </div>
                <!-- end nav-btn -->
              </div>
              <!-- end menu-wrapper -->
            </div>
            <!-- end col-lg-12 -->
          </div>
          <!-- end row -->
        </div>
        <!-- end container-fluid -->
      </div>
      <!-- end dashboard-nav -->
      <div class="dashboard-content-wrap">
        <div class="dashboard-bread dashboard-bread-2">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col-lg-6">
                <div class="breadcrumb-content">
                  <div class="section-heading">
                    <h2 class="sec__title font-size-30 text-white">
                      Dashboard
                    </h2>
                  </div>
                </div>
                <!-- end breadcrumb-content -->
              </div>
              <!-- end col-lg-6 -->
              <div class="col-lg-6">
                <div class="breadcrumb-list text-end">
                  <ul class="list-items">
                    <li><a href="./create-new-flight.html" class="text-white">Create New a Flight</a></li>
                  </ul>
                </div>
                <!-- end breadcrumb-list -->
              </div>
              <!-- end col-lg-6 -->
            </div>
            <!-- end row -->
            <div class="row mt-4">
              <div class="col-lg-3 responsive-column-l">
                <div class="icon-box icon-layout-2 dashboard-icon-box pb-0">
                  <div class="d-flex pb-3 justify-content-between">
                    <div class="info-content">
                      <p class="info__desc">Total No. of flight package</p>
                      <h4 class="info__title"> <span id="packageTotalCount"></span></h4>
                    </div>
                    <!-- end info-content -->
                    <div class="info-icon icon-element bg-4">
                      <i class="la la-bookmark-o"></i>
                    </div>
                    <!-- end info-icon-->
                  </div>
                  <div class="section-block"></div>
                  <a
                    href="admin-dashboard-booking.html"
                    class="d-flex align-items-center justify-content-between view-all"
                    >View All <i class="la la-angle-right"></i
                  ></a>
                </div>
              </div>
              <div class="col-lg-3 responsive-column-l">
                <div class="icon-box icon-layout-2 dashboard-icon-box pb-0">
                  <div class="d-flex pb-3 justify-content-between">
                    <div class="info-content">
                      <p class="info__desc">Total No. of contact messages</p>
                      <h4 class="info__title" id="contactTotalCount"></h4>
                    </div>
                    <!-- end info-content -->
                    <div class="info-icon icon-element bg-4">
                      <i class="la la-bookmark-o"></i>
                    </div>
                    <!-- end info-icon-->
                  </div>
                  <div class="section-block"></div>
                  <a
                    href="contact-message.html"
                    class="d-flex align-items-center justify-content-between view-all"
                    >View All <i class="la la-angle-right"></i
                  ></a>
                </div>
              </div>
              <div class="col-lg-3 responsive-column-l">
                <div class="icon-box icon-layout-2 dashboard-icon-box pb-0">
                  <div class="d-flex pb-3 justify-content-between">
                    <div class="info-content">
                      <p class="info__desc">Total No. of booking applications</p>
                      <h4 class="info__title" id="bookingTotalCount" ></h4>
                    </div>
                    <!-- end info-content -->
                    <div class="info-icon icon-element bg-4">
                      <i class="la la-bookmark-o"></i>
                    </div>
                    <!-- end info-icon-->
                  </div>
                  <div class="section-block"></div>
                  <a
                    href="booking-application.html"
                    class="d-flex align-items-center justify-content-between view-all"
                    >View All <i class="la la-angle-right"></i
                  ></a>
                </div>
              </div>
            </div>
            <!-- end row -->
          </div>
        </div>
      
      </div>
      <!-- end dashboard-content-wrap -->
    </section>
    <!-- end dashboard-area -->
    <!-- ================================
    END DASHBOARD AREA
================================= -->

    <!-- start scroll top -->
    <div id="back-to-top">
      <i class="la la-angle-up" title="Go top"></i>
    </div>
    <!-- end scroll top -->
    
    <!-- Template JS Files -->
    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/select2.min.js"></script>
    <script src="js/moment.min.js"></script>
    <script src="js/daterangepicker.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.fancybox.min.js"></script>
    <script src="js/jquery.countTo.min.js"></script>
    <script src="js/animated-headline.js"></script>
    <!-- <script src="js/jquery.sparkline.js"></script> -->
    <script src="js/dashboard.js"></script>
    <!-- <script src="js/chart.js"></script> -->
    <!-- <script src="js/chart.extension.js"></script> -->
    <!-- <script src="js/bar-chart.js"></script> -->
    <!-- <script src="js/line-chart.js"></script> -->
    <script src="js/jquery.ripples-min.js"></script>
    <script src="js/contact-messages.js"></script>
    <script src="js/booking-applications.js"></script>
    <script src="js/all-flight-packages.js"></script>
    <script src="js/main.js"></script>
    <script>
      
    document.addEventListener("DOMContentLoaded", () => {
      const packageTotalCount = document.getElementById("packageTotalCount");
      
      // Redirect if not authorized
      if (!accessToken) {
        alert("You are not authorized to access this page.");
        window.location.href = "index.html";
    }
    
    async function updatePackageCounts() {
      try {
        const response = await fetch(`${BASE_API_URL}/flight/packages/count/`, {
            headers: { Authorization: `Bearer ${accessToken}` },
          });

          if (!response.ok) {
            throw new Error("Failed to fetch package count");
          }

          const { total_active_count } = await response.json();

          if (packageTotalCount) {
            packageTotalCount.textContent = total_active_count;
          } else {
            console.error("packageTotalCount element not found");
          }
          
        } catch (error) {
          console.error("Failed to update package counts:", error);
        }
      }

      // Call this function wherever appropriate in your code
      updatePackageCounts();
    });
    
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const bookingTotalCount = document.getElementById("bookingTotalCount");
        const bookingRecentCount = document.getElementById("bookingRecentCount");
        const bookingNotiCount = document.getElementById("booking-noti-count");
        // update booking counts
        async function updateBookingCounts() {
          try {
            const response = await fetch(`${BASE_API_URL}/flight/booking-applications/count/`, {
              headers: { Authorization: `Bearer ${accessToken}` },
            });

            if (!response.ok) {
              throw new Error("Failed to fetch booking count");
            }

            const { total_active_count } = await response.json();

            if (bookingTotalCount) {
              bookingTotalCount.textContent = total_active_count;
              bookingNotiCount.textContent = total_active_count;
            } else {
              console.error("bookingTotalCount element not found");
            }

            // if (bookingRecentCount) {
            //   bookingRecentCount.textContent = recent_count;
            // } else {
            //   console.error("bookingRecentCount element not found");
            // }
          } catch (error) {
            console.error("Failed to update booking counts:", error);
          }
        }

        updateBookingCounts();
        
      });
    </script>
  </body>
</html>
